# üöÄ Coolify Monitoring Stack

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Å—Ç–µ–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–ª—è Coolify —Å–µ—Ä–≤–µ—Ä–æ–≤ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –º–µ—Ç—Ä–∏–∫, –ª–æ–≥–æ–≤ –∏ –∫—Ä–∞—Å–∏–≤—ã—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä **–ú–µ—Ç—Ä–∏–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤** - CPU, RAM, –¥–∏—Å–∫, —Å–µ—Ç—å
- üê≥ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Docker** - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —Ä–µ—Å—É—Ä—Å—ã, –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- üìù **–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏** - –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ
- üéØ **–ì–æ—Ç–æ–≤—ã–µ –¥–∞—à–±–æ—Ä–¥—ã** - –∫—Ä–∞—Å–∏–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∫–æ–º–∞–Ω–¥—ã
- üîî **–ê–ª–µ—Ä—Ç—ã** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- üìà **–ò—Å—Ç–æ—Ä–∏—è** - –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤–æ –≤—Ä–µ–º–µ–Ω–∏

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
[–°–µ—Ä–≤–µ—Ä 1 Coolify] ‚îÄ‚îÄ‚îê
[–°–µ—Ä–≤–µ—Ä 2 Coolify] ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚ñ∫ [Promtail] ‚îÄ‚îÄ‚ñ∫ [Loki] ‚îÄ‚îÄ‚ñ∫ [Grafana]
[–°–µ—Ä–≤–µ—Ä 3 Coolify] ‚îÄ‚îÄ‚îò                    [–î–∞—à–±–æ—Ä–¥—ã]

[–°–µ—Ä–≤–µ—Ä 1 Coolify] ‚îÄ‚îÄ‚îê
[–°–µ—Ä–≤–µ—Ä 2 Coolify] ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚ñ∫ [Node Exporter] ‚îÄ‚îÄ‚ñ∫ [Prometheus] ‚îÄ‚îÄ‚ñ∫ [Grafana]
[–°–µ—Ä–≤–µ—Ä 3 Coolify] ‚îÄ‚îÄ‚îò                                    [–î–∞—à–±–æ—Ä–¥—ã]
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Coolify (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
```bash
git clone <your-repo>
cd coolify-monitoring-stack
docker-compose up -d
```

**‚úÖ –ì–æ—Ç–æ–≤–æ –¥–ª—è Coolify:** –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤ Coolify!

### 2. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
```bash
# –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Ñ–∞–π–ª
docker-compose -f docker-compose.local.yml up -d
```

### 3. –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º
- **Grafana:** http://localhost:3111 (admin/admin123)
- **Prometheus:** http://localhost:9090
- **Loki:** http://localhost:3100
- **cAdvisor:** http://localhost:8081 (Coolify) / http://localhost:8080 (–ª–æ–∫–∞–ª—å–Ω–æ)

### 3. –ü–µ—Ä–≤—ã–π –≤—Ö–æ–¥ –≤ Grafana
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:3000
2. –õ–æ–≥–∏–Ω: `admin`
3. –ü–∞—Ä–æ–ª—å: `admin123`
4. –î–∞—à–±–æ—Ä–¥—ã –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤ Coolify

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node Exporter –Ω–∞ –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–µ—Ä:**
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ Coolify
curl -fsSL https://github.com/prometheus/node_exporter/releases/download/v1.6.1/node_exporter-1.6.1.linux-amd64.tar.gz | tar xvz
sudo mv node_exporter-1.6.1.linux-amd64/node_exporter /usr/local/bin/
sudo systemctl enable node_exporter
sudo systemctl start node_exporter
```

2. **–û–±–Ω–æ–≤–∏—Ç–µ prometheus.yml:**
```yaml
- job_name: 'coolify-servers'
  static_configs:
    - targets: 
      - '192.168.1.10:9100'  # –°–µ—Ä–≤–µ—Ä 1
      - '192.168.1.11:9100'  # –°–µ—Ä–≤–µ—Ä 2
      - '192.168.1.12:9100'  # –°–µ—Ä–≤–µ—Ä 3
```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Prometheus:**
```bash
docker-compose restart prometheus
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ NestJS –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç—ã:**
```bash
npm install winston winston-loki @willsoto/nestjs-prometheus prom-client
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```typescript
// winston.config.ts
import { WinstonModule } from 'nest-winston';
import * as winston from 'winston';
import LokiTransport from 'winston-loki';

export const winstonConfig = WinstonModule.createLogger({
  transports: [
    new winston.transports.Console(),
    new LokiTransport({
      host: "http://your-loki-server:3100",
      json: true,
      labels: { job: 'nestjs-app' },
      format: winston.format.json(),
      replaceTimestamp: true
    })
  ]
});
```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–µ—Ç—Ä–∏–∫–∏:**
```typescript
// app.module.ts
import { PrometheusModule } from '@willsoto/nestjs-prometheus';

@Module({
  imports: [
    PrometheusModule.register({
      path: '/metrics',
      defaultMetrics: { enabled: true }
    })
  ]
})
export class AppModule {}
```

## üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞—à–±–æ—Ä–¥—ã

### System Overview
- CPU, RAM, –¥–∏—Å–∫, —Å–µ—Ç—å
- –°–∏—Å—Ç–µ–º–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –ø—Ä–æ–±–ª–µ–º

### Docker Containers
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏
- –°–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫
- –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### –õ–æ–≥–∏ (—á–µ—Ä–µ–∑ Explore)
- –ü–æ–∏—Å–∫ –ø–æ –≤—Å–µ–º —Å–µ—Ä–≤–∏—Å–∞–º
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –º–µ—Ç–∫–∞–º
- –ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:
1. **HTTPS** –¥–ª—è –≤—Å–µ—Ö –≤–Ω–µ—à–Ω–∏—Ö URL
2. **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è** –≤ Grafana
3. **Firewall** –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø–æ—Ä—Ç–æ–≤
4. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è** –¥–ª—è –ø–∞—Ä–æ–ª–µ–π

### –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞:
```bash
# .env
GF_SECURITY_ADMIN_PASSWORD=your_secure_password
```

## üö® –ê–ª–µ—Ä—Ç—ã

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:
1. **–í Grafana** ‚Üí Alerting ‚Üí Notification channels
2. **–î–æ–±–∞–≤—å—Ç–µ** Slack, Telegram, Email
3. **–°–æ–∑–¥–∞–π—Ç–µ** –ø—Ä–∞–≤–∏–ª–∞ –∞–ª–µ—Ä—Ç–æ–≤
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ** –ø–æ—Ä–æ–≥–∏ –¥–ª—è CPU, RAM, –¥–∏—Å–∫–∞

### –ü—Ä–∏–º–µ—Ä –∞–ª–µ—Ä—Ç–∞:
```yaml
# CPU > 90% –Ω–∞ 5 –º–∏–Ω—É—Ç
expr: 100 - (avg by (instance) (irate(node_cpu_seconds_total{mode="idle"}[5m])) * 100) > 90
for: 5m
```

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:
1. **–î–æ–±–∞–≤–ª—è–π—Ç–µ —Å–µ—Ä–≤–µ—Ä—ã** –≤ prometheus.yml
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫—É** –¥–ª—è Grafana
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–µ** –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Prometheus/Loki

### –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:
1. **–£–≤–µ–ª–∏—á—å—Ç–µ —Ä–µ—Å—É—Ä—Å—ã** –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ retention** –¥–ª—è –º–µ—Ç—Ä–∏–∫
3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ** –∑–∞–ø—Ä–æ—Å—ã

## üÜò –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### Prometheus –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
docker-compose ps prometheus

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
docker-compose logs prometheus

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
curl http://localhost:9090/api/v1/targets
```

### Loki –Ω–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ª–æ–≥–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
docker-compose ps loki

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
docker-compose logs loki

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Promtail
docker-compose logs promtail
```

### Grafana –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å
docker-compose ps grafana

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
docker-compose logs grafana

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ volumes
docker volume ls
```

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **Issues:** –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –≤ GitHub
- **Discussions:** –û–±—Å—É–∂–¥–∞–π—Ç–µ –≤ GitHub Discussions
- **Wiki:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≤–æ–±–æ–¥–Ω–æ!

---

**–°–æ–∑–¥–∞–Ω–æ —Å ‚ù§Ô∏è –¥–ª—è —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ Coolify**
